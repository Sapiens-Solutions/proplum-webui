# proplum UI-приложение

## Описание

proplum - это бесплатный open-source ETL-инструмент для автоматизации загрузки данных и расчетов в Greenplum, разработанный командой Sapiens solutions. Этот инструмент значительно ускоряет процесс загрузки данных и упрощает работу с ними.

## Производственное развертывание

1. Разархивируйте архивы с образами с помощью команд:
   ```
   docker load -i web-ui-nginx.tar.gz
   docker load -i web-ui-backend.tar.gz
   ```

2. Скопируйте файл `.env.example` в `.env`:
   ```
   cp .env.example .env
   ```

3. Отредактируйте файл `.env`, заполнив необходимые переменные окружения (см. раздел "Конфигурация").

4. Запустите приложение с помощью Docker Compose:
   ```
   docker-compose -f docker-compose.offline.yml up -d 
   ```
   либо в зависимости от версии Docker Compose
   ```
   docker compose -f docker-compose.offline.yml up -d
   ```

5. Приложение будет доступно по адресу `http://your-server-ip:8080`.

## Конфигурация

В корневой директории проекта находится файл `.env.example`, который содержит шаблон конфигурации. Скопируйте его в файл `.env` и заполните необходимыми значениями.

### Обязательные переменные окружения

Следующие переменные должны быть определены в файле `.env`:

- `DB_LOGIN`: Логин для подключения к базе данных
- `DB_PASSWORD`: Пароль для подключения к базе данных
- `DB_HOST`: Хост или IP-адрес базы данных
- `DB_PORT`: Порт, на котором работает база данных (по умолчанию 5432)
- `DB_NAME`: Имя базы данных
- `APP_CONFIG__DB__DATABASE_SCHEMA`: Схема базы данных (по умолчанию "fw")
- `VITE_AIRFLOW_URL`: URL для Airflow

### Опциональные переменные окружения

Эти переменные имеют значения по умолчанию, но могут быть изменены при необходимости:

- `APP_CONFIG__DB__URL`: URL для подключения к базе данных (автоматически формируется из обязательных переменных)
- `APP_CONFIG__DB__ECHO`: Режим вывода SQL-запросов (0 - выключен, 1 - включен)
- `APP_CONFIG__RUN__HOST`: Хост, на котором будет запущен backend (по умолчанию "127.0.0.1")
- `APP_CONFIG__RUN__PORT`: Порт, на котором будет работать backend (по умолчанию 8000)
- `APP_CONFIG__RUN__ALLOWED_ORIGIN`: Настройка CORS (список разрешенных источников через запятую, пусто для разрешения всех)
- `VITE_BACKEND_URL`: URL для API-запросов к backend (по умолчанию "/api")
- `NODE_ENV`: Окружение Node.js (по умолчанию "production")

## Структура проекта

Проект состоит из двух основных компонентов:

1. Backend (API):
   - Контейнер: `proplum-ui-backend`
   - Dockerfile: `./docker/prod/Dockerfile.backend`
   - Порт: 8000 (внутренний)

2. Frontend (Nginx):
   - Контейнер: `proplum-ui-frontend`
   - Dockerfile: `./docker/prod/Dockerfile.frontend`
   - Порт: 8080 (внешний)

## Дополнительные параметры

### Backend

- **Healthcheck**: Настроен для проверки работоспособности backend каждые 30 секунд
- **Restart policy**: `unless-stopped` (автоматический перезапуск при сбоях)

### Frontend

- Nginx сервер настроен для раздачи статических файлов и проксирования запросов к API
