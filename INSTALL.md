# Инструкция по установке proplum UI

## Предварительные требования

⚠️ **ВАЖНО**: На целевой базе данных должен быть предварительно развернут ETL-фреймворк proplum. UI-приложение работает только с уже установленным и настроенным фреймворком.

### Системные требования:
- Docker (версия 20.10 или выше)
- Docker Compose (версия 2.0 или выше)
- Доступ к базе данных с развернутым фреймворком proplum
- Доступ к Airflow (опционально, если планируется интеграция)

## Пошаговая инструкция установки

### 1. Получение приложения

```bash
# Клонируйте репозиторий
git clone https://github.com/your-repo/proplum-ui.git

# Перейдите в директорию проекта
cd proplum-ui
```

### 2. Настройка конфигурации

```bash
# Создайте файл конфигурации из примера
cp .env.example .env
```

Отредактируйте файл `.env`, указав следующие **обязательные** параметры:

```ini
# Параметры подключения к базе данных
DB_LOGIN=your_db_login        # Укажите логин пользователя БД
DB_PASSWORD=your_db_password  # Укажите пароль пользователя БД
DB_HOST=your_db_host         # Укажите хост БД (например, 192.168.1.100)
DB_NAME=your_db_name         # Укажите имя БД
DB_PORT=5432                 # Измените порт, если отличается от 5432

# URL для Airflow (если используется)
VITE_AIRFLOW_URL=https://your-airflow-url.com
```

### 3. Запуск приложения

```bash
# Запустите приложение в фоновом режиме
docker-compose up -d
```

После успешного запуска вы увидите сообщение о создании двух контейнеров:
- `proplum-ui-backend`
- `proplum-ui-frontend`

### 4. Проверка работоспособности

1. Проверьте, что оба контейнера запущены:
```bash
docker-compose ps
```

Вы должны увидеть статус `UP` для обоих контейнеров.

2. Проверьте доступность приложения:
- Откройте в браузере: `http://localhost:8080`
- Должна отобразиться страница входа в proplum UI

### 5. Проверка логов (при необходимости)

Если возникли проблемы, проверьте логи контейнеров:

```bash
# Логи backend
docker-compose logs backend

# Логи frontend
docker-compose logs nginx
```

## Устранение неполадок

### Проблема 1: Приложение не запускается
- Проверьте, что все обязательные переменные в `.env` заполнены корректно
- Убедитесь, что указанные порты (8080, 8000) не заняты другими приложениями

### Проблема 2: Ошибка подключения к базе данных
- Проверьте доступность базы данных с хоста, где запущено приложение
- Убедитесь, что пользователь БД имеет необходимые права доступа
- Проверьте, что схема `fw` существует в базе данных

### Проблема 3: Ошибка загрузки UI
- Проверьте, что значение `VITE_BACKEND_URL` в `.env` указано корректно
- Убедитесь, что nginx контейнер успешно запущен и прослушивает порт 8080

## Обновление приложения

Для обновления приложения выполните следующие команды:

```bash
# Остановите текущие контейнеры
docker-compose down

# Получите последние изменения из репозитория
git pull

# Пересоберите и запустите контейнеры
docker-compose up -d --build
```

## Дополнительная информация

- Приложение использует порт 8080 для веб-интерфейса
- Backend API работает на порту 8000
- Все данные и настройки хранятся в подключенной базе данных
- При изменении конфигурации в файле `.env` требуется перезапуск контейнеров

